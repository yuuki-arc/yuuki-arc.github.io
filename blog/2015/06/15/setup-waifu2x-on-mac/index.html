<!DOCTYPE html> <html lang=ja> <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"> <link rel=canonical href="//yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/"/> <meta charset=utf-8> <meta name=viewport content="width=device-width, initial-scale=1.0"> <title>Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co</title> <meta name=author content=yuuki-arc> <meta name=keywords content="スマホゲーム開発,Web開発,Cocos2d-x,PHP,Ruby on Rails"/> <meta name=description content="夕希／ユウキのブログ。個人的に興味のある開発関連を中心に書いていきます。"/> <meta name="twitter:card" content=summary /> <meta name="twitter:url" content="http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/"/> <meta name="twitter:title" content="Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co"/> <meta name="twitter:site" content="@yuuki_arc"/> <meta name="twitter:description" content="夕希／ユウキのブログ。個人的に興味のある開発関連を中心に書いていきます。"/> <meta property="fb:app_id" content=716736618373642 /> <meta property="og:type" content=article /> <meta property="og:url" content="http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/"/> <meta property="og:title" content="Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co"/> <meta property="og:description" content="夕希／ユウキのブログ。個人的に興味のある開発関連を中心に書いていきます。"> <meta property="og:site_name" content="yuukiar.co"> <meta property="og:locale" content=ja_JP> <meta property="article:publisher" content="https://www.facebook.com/yamaoka.masaki"> <meta name=pocket-site-verification content=6d1e982bc9308213ce9782d70a2e2e /> <link rel=alternate type="application/rss+xml" href="/feed.xml" title="yuukiar.co"> <link rel=author href="https://plus.google.com/109349508125790933002/posts"> <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"> <link href="/css/font-awesome.min.css" rel=stylesheet /> <!--[if lt IE 9]><link href="/css/html5.css" rel=stylesheet /><![endif]--> <!--[if IE 7]><link href="/css/font-awewsome-ie7.css" rel=stylesheet /><![endif]--> <link href='//fonts.googleapis.com/css?family=Nunito' rel=stylesheet> <link href="/css/all.css" rel=stylesheet /> <!--[if lte IE 8]><link href="/css/ie8.css" rel=stylesheet /><![endif]--> <!--[if lte IE 7]><link href="/css/ie7.css" rel=stylesheet /><![endif]--> <link href="/css/highlight_syntax.css" rel=stylesheet /> <script src="/js/all.js"></script> <!--[if lte IE 7]><script src="/js/jquery.boxsizing.js"></script><![endif]--> <script src="/js/banzhow.js"></script> <script>window._pt_lt = new Date().getTime();</script> <link rel="shortcut icon" href="/img/favicon/favicon.ico"> <link rel=apple-touch-icon sizes=57x57 href="/img/favicon/apple-touch-icon-57x57.png"> <link rel=apple-touch-icon sizes=114x114 href="/img/favicon/apple-touch-icon-114x114.png"> <link rel=apple-touch-icon sizes=72x72 href="/img/favicon/apple-touch-icon-72x72.png"> <link rel=apple-touch-icon sizes=144x144 href="/img/favicon/apple-touch-icon-144x144.png"> <link rel=apple-touch-icon sizes=60x60 href="/img/favicon/apple-touch-icon-60x60.png"> <link rel=apple-touch-icon sizes=120x120 href="/img/favicon/apple-touch-icon-120x120.png"> <link rel=apple-touch-icon sizes=76x76 href="/img/favicon/apple-touch-icon-76x76.png"> <link rel=apple-touch-icon sizes=152x152 href="/img/favicon/apple-touch-icon-152x152.png"> <meta name=apple-mobile-web-app-title content="yuukiar.co"> <link rel=icon type="image/png" href="/img/favicon/favicon-196x196.png" sizes=196x196> <link rel=icon type="image/png" href="/img/favicon/favicon-160x160.png" sizes=160x160> <link rel=icon type="image/png" href="/img/favicon/favicon-96x96.png" sizes=96x96> <link rel=icon type="image/png" href="/img/favicon/favicon-16x16.png" sizes=16x16> <link rel=icon type="image/png" href="/img/favicon/favicon-32x32.png" sizes=32x32> <meta name=msapplication-TileColor content="#da532c"> <meta name=msapplication-TileImage content="/img/favicon/mstile-144x144.png"> <meta name=msapplication-config content="/img/favicon/browserconfig.xml"> <meta name=application-name content="yuukiar.co"> </head> <body> <nav class="navbar navbar-fixed-top navbar-inverse" role=navigation> <div class=container> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=".navbar-ex1-collapse"> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href="/">yuukiar.co</a> </div> <div class="collapse navbar-collapse navbar-ex1-collapse"> <ul class="nav navbar-nav navbar-right"> <li><a href="/">Home</a></li> <li><a href="/apps/mikumo-burst/">Apps</a></li> </ul> </div> </div> </nav> <div class=section-header> <div class=container> <div class=row> <div class=col-lg-12> <h1 class=page-header>Blog</h1> </div> </div> </div> </div> <div class="container container-int"> <ol class=breadcrumb> <li><a href="/">Home</a></li> <li class=active>Blog</li> </ol> <div class=row> <div class="col-md-8 col-sm-8"> <div class=post> <h1 class=post-title><a href="./">Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする</a></h1> <p class=post-meta> <i class="fa fa-calendar-o first"></i> 2015-06-15 <i class="fa fa-tags"></i> <span class="tags tags-article-header"> <a href="/blog/tags/mac/">Mac</a> <a href="/blog/tags/yosemite/">Yosemite</a> <a href="/blog/tags/waifu2x/">waifu2x</a> </span> </p> <div class=share> <div class=twitter><a href="//twitter.com/intent/tweet?url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;text=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" target=_blank><i class="fa fa-twitter"></i><span> twitter</span></a></div> <div class=facebook><a href="//www.facebook.com/sharer.php?u=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;t=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" target=_blank><i class="fa fa-facebook-square"></i><span> facebook</span></a></div> <div class=hatena><a href="//b.hatena.ne.jp/add?mode=confirm&amp;url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;title=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" target=_blank><i class="fa fa-hatena">B!</i><span> はてブ</span></a></div> <div class=gplus><a href="https://plus.google.com/share?url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;title=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target=_blank><i class="fa fa-google-plus"></i><span> google+</span></a></div> <div class=pocket><a href="//getpocket.com/edit?url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;title=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target=_blank><i class="fa fa-chevron-down"></i><span> Pocket</span></a></div> </div> <p>最近スマホゲームの素材探しをしていてその過程でwaifu2xというツールを知ったのですが、 素材加工のクオリティアップにかなり使えそうなのでセットアップ方法を残しておきます。</p> <p>細かい説明はいろんなところで紹介されているのでここで説明しませんが、 簡単にいうと、waifu2xとは二次元画像を綺麗に拡大できるツールです。</p> <p>自分の環境がMac OS X Yosemiteなので、Macでのセットアップ方法を探していたのですが、 見当たらなかったので、自分でセットアップした手順について書いていきます。 waifu2xは最近のトレンドのようで派生版があちこちにあるのですが、 いくつかMacで動いたのでそれらのセットアップ手順を紹介します。</p> <h3 id="見出し">見出し</h3> <ul> <li><a href="#この記事のwaifu2xについて">この記事のwaifu2xについて</a> <ul> <li><a href="#この記事で扱うwaifu2x">この記事で扱うwaifu2x</a></li> <li><a href="#この記事では扱わないが気になるwaifu2x">この記事では扱わないが気になるwaifu2x</a></li> </ul></li> <li><a href="#1.-ライブラリのインストール">1. ライブラリのインストール</a></li> <li><a href="#2.-waifu2x(cui版)のセットアップ">2. waifu2x(CUI版)のセットアップ</a> <ul> <li><a href="#waifu2x-converter-glsl-(ueshita)">waifu2x-converter-glsl (ueshita)</a></li> <li><a href="#waifu2x-converter-cpp-(wl-amigo)">waifu2x-converter-cpp (WL-Amigo)</a></li> </ul></li> <li><a href="#3.-waifu2x(gui版)のセットアップ">3. waifu2x(GUI版)のセットアップ</a> <ul> <li><a href="#waifu2x-converter-qt-(khws4v1)">waifu2x-converter-qt (khws4v1)</a></li> </ul></li> </ul> <h2 id="この記事のwaifu2xについて">この記事のwaifu2xについて</h2> <h3 id="この記事で扱うwaifu2x">この記事で扱うwaifu2x</h3> <p>コマンドラインで使える派生版を２つと、それをフロントエンドで使えるGUIを１つ紹介します。<br> 結論から書くと、今のところはコマンドラインで <strong>waifu2x-converter-glsl</strong> を使っていて、フロントエンドに <strong>waifu2x-converter-qt</strong> を使ってます。 フロントエンド側からは <strong>waifu2x-converter-glsl</strong> へのパスを設定してそれを使うようにします。</p> <p>ただ、コマンドラインのほうは少々使いづらいです。 本来、パスを通せばどのディレクトリからでも実行できるようになってほしいのですが、 作業ディレクトリに依存している箇所があるため、実行するときはwaifu2x-converter-glslのディレクトリから実行しないとエラーになります。 このあたりはきちんと解決してから記事にしたかったのですが&hellip;あまり時間かけたくないので今のところはこれで我慢します。</p> <p>それと、今後の他ツールの動向によっては変えていくこともあるかと思います。</p> <h4 id=cui>CUI</h4> <ul> <li><a href="https://github.com/ueshita/waifu2x-converter-glsl">ueshita/waifu2x-converter-glsl - GitHub</a> <ul> <li>OpenGLで動かせるようにしたバージョン。</li> </ul></li> <li><a href="https://github.com/WL-Amigo/waifu2x-converter-cpp">WL-Amigo/waifu2x-converter-cpp - GitHub</a> <ul> <li>オリジナル版をC++で書きなおしたバージョン。更新はもうされないそうです。</li> </ul></li> </ul> <h4 id=gui>GUI</h4> <ul> <li><a href="https://github.com/khws4v1/waifu2x-converter-qt">khws4v1/waifu2x-converter-qt - GitHub</a> <ul> <li>Macでも動かせるフロントエンドツール。</li> <li><a href="//khws4v1.myhome.cx/article/2015/06/07/waifu2x-converter-qt%E3%81%AE%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA%E9%85%8D%E5%B8%83/">waifu2x-converter-qtのバイナリ配布 | かひわし4v1.memo</a></li> <li><a href="//khws4v1.myhome.cx/article/2015/06/01/waifu2x-converter-qt_linux_x64/">waifu2x-converter-cppのGUIフロントエンド”waifu2x-converter-qt”のバイナリを公開しました※ | かひわし4v1.memo</a></li> </ul></li> </ul> <h3 id="この記事では扱わないが気になるwaifu2x">この記事では扱わないが気になるwaifu2x</h3> <p>ここでは扱いませんが、個人的にここはチェックしておきたいなというものを書いておきます。</p> <ul> <li><a href="//waifu2x.udp.jp/">http://waifu2x.udp.jp/</a> <ul> <li>Webから使える。気になるというか、これでwaifu2xを知ったので。</li> </ul></li> <li><a href="https://github.com/nagadomi/waifu2x">nagadomi/waifu2x - GitHub</a> <ul> <li>waifu2xのオリジナル。luaで書かれているようです。</li> </ul></li> <li><a href="https://github.com/tanakamura/waifu2x-converter-cpp">tanakamura/waifu2x-converter-cpp</a> <ul> <li>現状いちばん頻繁に更新されてるので追っていきたいところですが、 コード見るとWindowsとLinuxにしか対応してない箇所があって、そのままだとコンパイルエラーで通りませんでした。<br></li> <li><a href="//d.hatena.ne.jp/w_o/20150602#1433229756">waifu2x はやくした - J</a></li> </ul></li> <li><a href="https://github.com/lltcggie/waifu2x-caffe">lltcggie/waifu2x-caffe - GitHub</a> <ul> <li>GUIとCUI両方使えて機能も豊富な模様。<br> Caffeというフレームワーク（？）で実装されていてMacでも使えるようですが、開発環境を整えるのが面倒だったので今のところ何もしてません。 でもよさそうなのでMacで使ってみたいですね。</li> </ul></li> </ul> <h2 id="1.-ライブラリのインストール">1. ライブラリのインストール</h2> <p>セットアップに入っていきます。 </p> <p>ライブラリのインストールにはHomebrewとgitを使います。 また この後インストールする waifu2x-converter-glsl のソースビルドにXCodeを使用します。 もしこれらが入っていなければ、他のサイトなどを参考にしてインストールしてください。</p> <p>今回必要になるOpenCVとOpenGLのライブラリをインストールしていきます。 バージョンは現時点（2015年6月15日）の最新版であるOpenGL3.1.1とOpenCV3.0.0で、 両方ともHomebrewからインストールします。</p> <pre class="highlight shell"><code><span class="gp">$ </span>brew tap homebrew/science
<span class="gp">$ </span>brew install opencv3 --with-opengl --with-qt5 --with-tbb --c++11
<span class="gp">$ </span>brew link --force opencv3

<span class="gp">$ </span>brew tap homebrew/versions
<span class="gp">$ </span>brew install glfw3 --universal
</code></pre> <ul> <li><strong>brew install するのは opencv ではなく opencv3</strong> である点に注意してください。（opencvを指定するとOpenCV2系のバージョンが入ります）</li> <li>opencv3の <code>--with-qt5</code> はフロントエンドの方で必要になります。 他のオプションは必要そうなのを入れてますが、いらないものもあるかもしれません。<br></li> <li><code>--force</code>でリンクするのは、opencv3の場合は自動的に <code>/usr/local/..</code> にシンボリックリンクがはられないためです。 このオプションを指定すると強制的にOpenCV3へのリンクがはられるので、すでに同ディレクトリにOpenCVが入っている人は実行しないほうがいいです。 ただし、その場合はXCodeプロジェクトで設定されているパスを書き換えないといけないです。（その場合のパターンはここでは説明しません）<br></li> <li>glfw3の <code>--universal</code> はスタティックライブラリを生成するオプションで、 waifu2x-converter-glsl のXCodeプロジェクトで指定してるので、インストールと同時に生成しておきます。</li> </ul> <h2 id="2.-waifu2x(cui版)のセットアップ">2. waifu2x(CUI版)のセットアップ</h2> <p>ここでは２つの派生版についてセットアップ手順を書いていきます。 waifu2xを使うにはどちらか1つセットアップできてればいいので、どちらか使いたい方を見てください。 簡単に違いを説明すると、</p> <ul> <li>waifu2x-converter-glsl (ueshita) <ul> <li>GPUを使うので実行中はグラフィックまわりの処理に負荷がかかる</li> <li>waifu2x-converter-cpp(WL-Amigo)に比べて処理速度が速い</li> <li>XCodeを使ったビルドでセットアップ手順が少々煩雑</li> <li>実行するときのカレントディレクトリはインストール場所固定</li> </ul></li> <li>waifu2x-converter-cpp (WL-Amigo) <ul> <li>CPUを使うので実行中は全体的に重くなる</li> <li>waifu2x-converter-glslに比べて処理速度が遅い</li> <li>CMakeを使ったビルドでモノが揃ってれば手順が簡単</li> <li>パスを通せば、実行するときのカレントディレクトリは任意（※オプション指定が必要）</li> </ul></li> </ul> <p>といった感じです。 処理速度はだいぶ違ってて、waifu2x-converter-glslのほうが目に見えて速いです。</p> <h3 id="waifu2x-converter-glsl-(ueshita)">waifu2x-converter-glsl (ueshita)</h3> <p>まずOpenGL版のほうから説明していきます。</p> <p>git cloneしてディレクトリに移動します。<br> 以降、このディレクトリでコマンドを入力していきます。</p> <pre class="highlight shell"><code><span class="gp">$ </span>git clone https://github.com/ueshita/waifu2x-converter-glsl
<span class="gp">$ </span><span class="nb">cd</span> <span class="o">[</span>git cloneしたディレクトリ]
</code></pre> <p>私の場合は下記の場所にインストールしたのでそのディレクトリに移動してます。</p> <pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">pwd</span>
/Users/hoge/src/github.com/ueshita/waifu2x-converter-glsl
</code></pre> <p>次にXCodeでビルドしていきます。<br> XCodeのプロジェクトは作者の方がリポジトリに含めてくれているので、それを使います。</p> <p>まず、ビルドする前に一回XCodeのアプリケーションを起動してプロジェクトを開きます。 そうしないとコマンドラインからのビルドでエラーになるからで、それを回避するためです。 プロジェクトのワークスペースがないといけないのですが、XCodeを起動すると作られるようです。</p> <p>マウスでアプリケーションを指定してプロジェクトを開いてもいいですし、 コマンドラインから以下のように実行することでも起動できます。</p> <pre class="highlight shell"><code><span class="gp">$ </span>open build/waifu2x-converter-glsl.xcodeproj
</code></pre> <p>ワークスペースを作るためだけに開くので、起動したらすぐに終了していいです。</p> <p>次のコマンドを実行するとXCodeでソースビルドを行います。 オプションのパラメータをわかりやすくするため、<code>\</code>で行を区切ってますが1行でもOKです。</p> <pre class="highlight shell"><code>xcodebuild <span class="se">\</span>
-project build/waifu2x-converter-glsl.xcodeproj <span class="se">\</span>
-scheme waifu2x-converter-glsl <span class="se">\</span>
-configuration Release <span class="se">\</span>
-derivedDataPath DerivedData
</code></pre> <p>ちなみに、もしここで以下のエラーが表示されたらワークスペースが作られてませんので、 XCodeを起動してプロジェクトを開いてください。（一つ前に書いた作業のことです）</p> <pre class="highlight shell"><code>xcodebuild: error: <span class="s1">'build/waifu2x-converter-glsl.xcodeproj'</span> does not exist.
</code></pre> <p><code>-derivedDataPath</code> で指定しているのがリリースバイナリが作られるディレクトリです。 このディレクトリに作られるファイルを起動出来る場所にコピーします。</p> <pre class="highlight shell"><code><span class="gp">$ </span>cp DerivedData/Build/Products/Release/waifu2x-converter-glsl .
</code></pre> <p>これで waifu2x-converter-glsl のセットアップは完了です。 ちなみにこのときの構成は以下のようになっています。</p> <pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">pwd</span>
/Users/hoge/src/github.com/ueshita/waifu2x-converter-glsl

<span class="gp">$ </span>tree -pugL 1
.
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  DerivedData
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  LICENSE
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  README.md
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  build
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  include
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  models
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  shaders
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  src
└── <span class="o">[</span>-rwxr-xr-x hoge   staff   <span class="o">]</span>  waifu2x-converter-glsl

6 directories, 3 files
</code></pre> <p>このディレクトリからファイルを実行することでwaifu2xが使えるようになります。</p> <p>ただし、ここで注意点があります。<br> 最初に書きましたが、これで使えるコマンドラインのほうは少々使いづらいです。 理由は、実行するときはこのwaifu2x-converter-glslのディレクトリに移動してから実行しないと使えないからです。</p> <p>作業ディレクトリに依存しているのは <code>models</code> と <code>shaders</code> にあるモジュールです。 このうち、 <code>models</code> に関してはwaifu2x-converter-glslのオプションに <code>--model_dir</code> というのがあり、 ここでパスを指定することで回避できますが、 <code>shaders</code> に関しては同様のオプションがありません。 なので作者の方にお願いするか、githubで公開されてるのでコードを修正してプルリクするなりしないといけないです。 時間があれば見てみようかなと思いましたが、そこまで手が回らなかったので今のところこのままにしてます。</p> <p>この問題に関してはインプット側の画像パスをフルパスにすればいいだけなので、 少々不便ではありますがこれでも十分使えるかなと思ってます。</p> <p>また、GUI版をインストールして waifu2x-converter-glsl を使うようにすれば この問題は関係なくなるので、GUI版メインで使う人は気にしなくていいです。</p> <h4 id="実行方法（例）">実行方法（例）</h4> <pre class="highlight plaintext"><code>$ cd ~/src/github.com/ueshita/waifu2x-converter-glsl
$ waifu2x-converter-glsl -i ~/Documents/test.jpg -m noise_scale -j 8 --scale_ratio 2.0 --noise_level 2
</code></pre> <h4 id="実行結果">実行結果</h4> <pre class="highlight plaintext"><code>Noise reduction (Lv.2) filtering...
split blocks 2x3 ...
process block (1,1) ...
[=======] ok
:
process block (6,4) ...
[=======] ok
process successfully done!
</code></pre> <h3 id="waifu2x-converter-cpp-(wl-amigo)">waifu2x-converter-cpp (WL-Amigo)</h3> <p>次に、他の派生版としてwaifu2x-converter-cpp(WL-Amigo)版もセットアップしてみます。</p> <p>こちらもまずはgit cloneしてディレクトリを移動します。</p> <pre class="highlight shell"><code><span class="gp">$ </span>git clone https://github.com/WL-Amigo/waifu2x-converter-cpp
<span class="gp">$ </span><span class="nb">cd</span> <span class="o">[</span>git cloneしたディレクトリ]
</code></pre> <p>私の場合は下記の場所にインストールしたのでそのディレクトリに移動してます。</p> <pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">pwd</span>
/Users/hoge/src/github.com/WL-Amigo/waifu2x-converter-cpp
</code></pre> <p>カレントディレクトリに <code>CMakeLists.txt</code> のファイルを作って、以下の内容を貼り付けます。</p> <pre class="highlight shell"><code>cmake_minimum_required<span class="o">(</span>VERSION 2.8<span class="o">)</span>

project<span class="o">(</span>waifu2x-converter-cpp CXX<span class="o">)</span>

<span class="nb">set</span><span class="o">(</span>CMAKE_CXX_FLAGS <span class="s2">"-std=c++11 -stdlib=libc++"</span><span class="o">)</span>
<span class="nb">set</span><span class="o">(</span>OpenCV_DIR <span class="s2">"/usr/local/opt/opencv3/share/OpenCV"</span><span class="o">)</span>
<span class="nb">set</span><span class="o">(</span>OpenCV_CONFIG_PATH <span class="s2">"/usr/local/opt/opencv3/share/OpenCV"</span><span class="o">)</span>
<span class="nb">set</span><span class="o">(</span>OpenCV_INSTALL_PATH <span class="s2">"/usr/local/opt/opencv3"</span><span class="o">)</span>
find_package<span class="o">(</span>OpenCV REQUIRED<span class="o">)</span>
include_directories<span class="o">(</span>include <span class="k">${</span><span class="nv">OpenCV_INCLUDE_DIRS</span><span class="k">}</span><span class="o">)</span>

add_executable<span class="o">(</span>waifu2x-converter-cpp src/main.cpp src/modelHandler.cpp src/convertRoutine.cpp<span class="o">)</span>
target_link_libraries<span class="o">(</span>waifu2x-converter-cpp <span class="k">${</span><span class="nv">OpenCV_LIBS</span><span class="k">}</span><span class="o">)</span>
</code></pre> <p>Homebrewの場合、OpenCVのライブラリは <code>/usr/local/opt/</code> 配下にシンボリックリンクで作られるので、 その場所を指定します。 cmakeはあまり詳しくないので最適な書き方ではないかもしれませんが、私の場合はこれでいけました。</p> <p>準備出来たのであとはコマンドを打つだけです。</p> <pre class="highlight shell"><code><span class="gp">$ </span>cmake .
<span class="gp">$ </span>make
</code></pre> <p>これで以下のように、 カレントディレクトリに <code>waifu2x-converter-cpp</code> というファイルが生成されていれば成功です。</p> <pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">pwd</span>
/Users/hoge/src/github.com/WL-Amigo/waifu2x-converter-cpp

<span class="gp">$ </span>tree -pugL 1
.
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  CMakeCache.txt
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  CMakeFiles
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  CMakeLists.txt
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  LICENSE
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  Makefile
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  README.md
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  appendix
├── <span class="o">[</span>-rw-r--r-- hoge   staff   <span class="o">]</span>  cmake_install.cmake
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  include
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  models
├── <span class="o">[</span>drwxr-xr-x hoge   staff   <span class="o">]</span>  src
└── <span class="o">[</span>-rwxr-xr-x hoge   staff   <span class="o">]</span>  waifu2x-converter-cpp

5 directories, 7 files
</code></pre> <p>あとはこのディレクトリに対してパスを通せば、どこからでも実行できるようになります。</p> <h4 id="実行方法（例）">実行方法（例）</h4> <p>パスを通した場合、任意の位置で実行することができます。 ただし、 <code>--model_dir</code>のオプションで <code>models</code> ディレクトリのパスを指定する必要は出てきます。</p> <pre class="highlight shell"><code><span class="gp">$ </span>waifu2x-converter-cpp --model_dir ~/src/github.com/WL-Amigo/waifu2x-converter-cpp/models -i ~/Documents/test-cpp.jpg -m noise_scale -j 8 --scale_ratio 1.2 --noise_level 1
</code></pre> <p>パスを通さない場合は、waifu2x-converter-glslと同じ書き方になります。 その代わり、 <code>--model_dir</code> のオプションを指定しなくてもよくなります。</p> <pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">cd</span> ~/src/github.com/WL-Amigo/waifu2x-converter-cpp/
<span class="gp">$ </span>waifu2x-converter-cpp -i ~/Documents/test-cpp.jpg -m noise_scale -j 8 --scale_ratio 1.2 --noise_level 1
</code></pre> <h4 id="実行結果">実行結果</h4> <pre class="highlight plaintext"><code>start process block (0,0) ...
Iteration #1...
Iteration #2...
:
Iteration #6...
Iteration #7...
process successfully done!
</code></pre> <h2 id="3.-waifu2x(gui版)のセットアップ">3. waifu2x(GUI版)のセットアップ</h2> <h3 id="waifu2x-converter-qt-(khws4v1)">waifu2x-converter-qt (khws4v1)</h3> <p>GUI版のwaifu2xをセットアップです。<br> Mac用のパッケージがリポジトリにあるのでそれを使います。<br> <a href="https://github.com/khws4v1/waifu2x-converter-qt/releases">https://github.com/khws4v1/waifu2x-converter-qt/releases</a></p> <p>waifu2x-converter-qt_Mac.dmg というファイル名のリンクがあるので、クリックしてダウンロードしてください。 ダウンロードしたファイルを展開すると <strong>waifu2x-converter-qt.app</strong> というファイルがあるので、 Applicationフォルダなど適当な場所においてください。</p> <p>アプリケーションを起動すると以下の様なウィンドウが表示されます。</p> <p><img alt="waifu2x-converter-qt フィルタ選択" src="/img/2015-06-15/waifu2x-converter-qt.png"/></p> <p>この派生版にもwaifu2xが内蔵されていますが、私の環境では下記のエラーで動きませんでした。</p> <pre class="highlight plaintext"><code>dyld: Library not loaded: /opt/local/lib/libgstbase-1.0.0.dylib`
</code></pre> <p>このエラーを調査してもいいですが、すでにコマンドラインで実行できる環境があるのでそちらを利用することにします。</p> <p>ということで、設定画面を開きます。 上部にあるメニューの「ツール」を選択して「設定」をクリックすると、次の設定ダイアログが開きます。</p> <p><img alt="waifu2x-converter-qt 設定" src="/img/2015-06-15/settings.png"/></p> <p>一つ目の入力欄の<strong>waifu2xの場所</strong> に、先ほどインストールしたコマンドラインのフルパスを入力してください。 私の環境であれば、それぞれ以下のように入れます。</p> <ul> <li><strong>waifu2x-converter-glsl</strong> を使う場合 <ul> <li>/Users/hoge/src/github.com/ueshita/waifu2x-converter-glsl/waifu2x-converter-glsl</li> </ul></li> <li><strong>waifu2x-converter-cpp</strong> を使う場合 <ul> <li>/Users/hoge/src/github.com/WL-Amigo/waifu2x-converter-cpp/waifu2x-converter-cpp</li> </ul></li> </ul> <p>OKボタンを押すと設定が反映されます。<br> これで準備が整いました。 画像を選択して実行すると、ダイアログがポップアップして処理結果が表示されます。</p> <p><img alt="waifu2x-converter-qt 処理結果" src="/img/2015-06-15/exec_result.png"/></p> <p>これでGUIでwaifu2xが使えるようになりました。</p> <div class=share> <div class=twitter><a href="//twitter.com/intent/tweet?url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;text=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" target=_blank><i class="fa fa-twitter"></i><span> twitter</span></a></div> <div class=facebook><a href="//www.facebook.com/sharer.php?u=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;t=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" target=_blank><i class="fa fa-facebook-square"></i><span> facebook</span></a></div> <div class=hatena><a href="//b.hatena.ne.jp/add?mode=confirm&amp;url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;title=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" target=_blank><i class="fa fa-hatena">B!</i><span> はてブ</span></a></div> <div class=gplus><a href="https://plus.google.com/share?url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;title=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target=_blank><i class="fa fa-google-plus"></i><span> google+</span></a></div> <div class=pocket><a href="//getpocket.com/edit?url=http://yuukiar.co/blog/2015/06/15/setup-waifu2x-on-mac/&amp;title=Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする - yuukiar.co" onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target=_blank><i class="fa fa-chevron-down"></i><span> Pocket</span></a></div> </div> <div class=well> <h3>関連記事</h3> <ol class=entries> <li><a href="/blog/2012/12/31/install-cocos2d-iphone-2-0/">Cocos2d-iphoneをインストールしてXcodeで使う</a></li> <li><a href="/blog/2014/09/07/mac-os-x-mavericks-in-virtualbox/">VirtualBoxで仮想Mac OS X(Mavericks)環境を構築する</a></li> <li><a href="/blog/2012/12/30/install-cocos2d-x-2-0-4/">Cocos2d-xをインストールしてXcodeで使う</a></li> </ol> </div> </div> <div class=text-center> <ul class=pagination> <li><a href="../../../05/30/global-game-jam-2015/"><i class="fa fa-angle-double-left"></i> 「Global Game Jam 2015」に参加しました／DEAD EYE LANDの体験コーナーあります</a></li> </ul> </div> </div> <div class="col-md-4 col-sm-4 sidebar"> <div class=well> <h4>このブログについて</h4> <div class=input-group> <p> <img class=profile-image src="/img/about.jpg"/> yuuki-arc </p> <p>夕希／ユウキのブログ。個人的に興味のある開発関連を中心に書いていきます。</p> </div> <ul class="list-inline list-unstyled social-networks"> <li> <a href="https://twitter.com/yuuki_arc"> <div class="icon-social icon-social-twitter normal"> <i class="fa fa-twitter"></i> </div> <div class="icon-social hover"> <i class="fa fa-twitter"></i> </div> </a> </li> <li> <a href="https://www.facebook.com/yamaoka.masaki"> <div class="icon-social icon-social-facebook normal"> <i class="fa fa-facebook"></i> </div> <div class="icon-social hover"> <i class="fa fa-facebook"></i> </div> </a> </li> <li> <a href="https://github.com/yuuki-arc"> <div class="icon-social icon-social-github normal"> <i class="fa fa-github"></i> </div> <div class="icon-social hover"> <i class="fa fa-github"></i> </div> </a> </li> </div> <div class=well> <h4>ブログ内検索</h4> <div class=input-group> <script>
  (function() {
    var cx = '012716547009313442516:6aaoiwbzeji';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script> <gcse:search></gcse:search> </div> </div> <div class=well> <h4>最新記事</h4> <ul class="nav nav-stacked nav-pills"> <li><a href="/blog/2015/06/15/setup-waifu2x-on-mac/"><i class="fa fa-caret-right"></i> 2015-06-15<br>Mac OS X Yosemiteでwaifu2xをインストールして使えるようにする</a></li> <li><a href="/blog/2015/05/30/global-game-jam-2015/"><i class="fa fa-caret-right"></i> 2015-05-30<br>「Global Game Jam 2015」に参加しました／DEAD EYE LANDの体験コーナーあります</a></li> <li><a href="/blog/2015/05/28/setup-zsh-tmux-on-cygwin-gnupack/"><i class="fa fa-caret-right"></i> 2015-05-28<br>gnupack(Cygwin) + oh-my-zsh + tmuxの環境を構築する</a></li> <li><a href="/blog/2015/04/04/windows-chocolatey/"><i class="fa fa-caret-right"></i> 2015-04-04<br>Windows 7でパッケージ管理システム「Chocolatey」を導入する</a></li> <li><a href="/blog/2015/02/05/line-game-boot-camp/"><i class="fa fa-caret-right"></i> 2015-02-05<br>LINE主催の「GAME BOOT CAMP」に参加してゲーム開発してきました！</a></li> </ul> </div> <div class=well> <h4>月別アーカイブ</h4> <li><a href="/blog/2015/">2015年</a> (8)</li> <ul> <li><a href="/blog/2015/06/">2015年6月</a> (1)</li> <li><a href="/blog/2015/05/">2015年5月</a> (2)</li> <li><a href="/blog/2015/04/">2015年4月</a> (1)</li> <li><a href="/blog/2015/02/">2015年2月</a> (1)</li> <li><a href="/blog/2015/01/">2015年1月</a> (3)</li> </ul> <li><a href="/blog/2014/">2014年</a> (6)</li> <ul> <li><a href="/blog/2014/12/">2014年12月</a> (1)</li> <li><a href="/blog/2014/09/">2014年9月</a> (2)</li> <li><a href="/blog/2014/08/">2014年8月</a> (3)</li> </ul> <li><a href="/blog/2013/">2013年</a> (6)</li> <ul> <li><a href="/blog/2013/05/">2013年5月</a> (1)</li> <li><a href="/blog/2013/04/">2013年4月</a> (1)</li> <li><a href="/blog/2013/03/">2013年3月</a> (2)</li> <li><a href="/blog/2013/01/">2013年1月</a> (2)</li> </ul> <li><a href="/blog/2012/">2012年</a> (13)</li> <ul> <li><a href="/blog/2012/12/">2012年12月</a> (4)</li> <li><a href="/blog/2012/11/">2012年11月</a> (2)</li> <li><a href="/blog/2012/10/">2012年10月</a> (5)</li> <li><a href="/blog/2012/01/">2012年1月</a> (2)</li> </ul> </div> <div class=well> <h4>タグ</h4> <div class=tags> <a href="/blog/tags/mac/">Mac (13)</a> <a href="/blog/tags/lion/">Lion (2)</a> <a href="/blog/tags/iphone/">iPhone (3)</a> <a href="/blog/tags/apple/">Apple (4)</a> <a href="/blog/tags/line/">LINE (2)</a> <a href="/blog/tags/instagram/">Instagram (1)</a> <a href="/blog/tags/webstagram/">Webstagram (1)</a> <a href="/blog/tags/google-analytics/">Google Analytics (1)</a> <a href="/blog/tags/ruby-on-rails/">Ruby on Rails (3)</a> <a href="/blog/tags/mountain-lion/">Mountain Lion (2)</a> <a href="/blog/tags/homebrew/">homebrew (2)</a> <a href="/blog/tags/rbenv/">rbenv (2)</a> <a href="/blog/tags/cocos2d-x/">Cocos2d-x (5)</a> <a href="/blog/tags/xcode/">Xcode (2)</a> <a href="/blog/tags/cocos2d-iphone/">Cocos2d-iphone (1)</a> <a href="/blog/tags/psp-vita/">PSP(Vita) (1)</a> <a href="/blog/tags/umd-passport/">UMD Passport (1)</a> <a href="/blog/tags/games/">Games (4)</a> <a href="/blog/tags/ebooks/">eBooks (1)</a> <a href="/blog/tags/pow/">pow (2)</a> <a href="/blog/tags/powder/">powder (1)</a> <a href="/blog/tags/sublime-text-2/">Sublime Text 2 (1)</a> <a href="/blog/tags/virtualbox/">VirtualBox (2)</a> <a href="/blog/tags/modern-ie/">modern.IE (1)</a> <a href="/blog/tags/internet-explorer/">Internet Explorer (1)</a> <a href="/blog/tags/middleman/">Middleman (2)</a> <a href="/blog/tags/github-pages/">GitHub Pages (2)</a> <a href="/blog/tags/particle-designer/">Particle Designer (1)</a> <a href="/blog/tags/glyph-designer/">Glyph Designer (1)</a> <a href="/blog/tags/unity3d/">Unity3D (3)</a> <a href="/blog/tags/mavericks/">Mavericks (1)</a> <a href="/blog/tags/texturepacker/">TexturePacker (1)</a> <a href="/blog/tags/physicseditor/">PhysicsEditor (1)</a> <a href="/blog/tags/apps/">Apps (2)</a> <a href="/blog/tags/yosemite/">Yosemite (2)</a> <a href="/blog/tags/mackup/">Mackup (1)</a> <a href="/blog/tags/brew-file/">Brew-file (1)</a> <a href="/blog/tags/homesick/">homesick (1)</a> <a href="/blog/tags/dotfiles/">dotfiles (1)</a> <a href="/blog/tags/zsh/">zsh (2)</a> <a href="/blog/tags/php/">PHP (2)</a> <a href="/blog/tags/phpbrew/">PHPBrew (2)</a> <a href="/blog/tags/windows/">Windows (2)</a> <a href="/blog/tags/chocolatey/">Chocolatey (1)</a> <a href="/blog/tags/cygwin/">Cygwin (1)</a> <a href="/blog/tags/tmux/">tmux (1)</a> <a href="/blog/tags/waifu2x/">waifu2x (1)</a> </div> </div> </div> </div> </div> <div class=footer-after> <div class=container> <div class=row> <p class=col-md-10>©2014 All rights reserved. Designed by John Doe. Customized by yuuki-arc.</p> </div> </div> </div> <script src="/js/ptengine.js"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-34476431-7', 'auto');
  ga('send', 'pageview');
</script> </body> </html>